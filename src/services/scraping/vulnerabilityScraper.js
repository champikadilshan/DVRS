// src/services/scraping/vulnerabilityScraper.js
import axios from 'axios';

const SCRAPING_API_URL = 'http://localhost:3001/api';

export const vulnerabilityScraper = {
  async scrapeVulnerabilityDetails(uri) {
    try {
      console.log('Starting vulnerability scrape for:', uri);
      const response = await axios.post(`${SCRAPING_API_URL}/scrape`, {
        url: uri
      });

      if (response.data.success) {
        console.log('Scraping successful, data saved as:', response.data.data.savedAs);
        return response.data.data;
      } else {
        throw new Error(response.data.message || 'Scraping failed');
      }
    } catch (error) {
      console.error('Scraping error:', error);
      throw new Error(`Failed to scrape vulnerability details: ${error.message}`);
    }
  },

  async getVulnerabilityData(cveId) {
    try {
      const response = await axios.get(`${SCRAPING_API_URL}/vulnerability/${cveId}`);
      return response.data;
    } catch (error) {
      console.error('Error retrieving vulnerability data:', error);
      throw new Error(`Failed to retrieve vulnerability data: ${error.message}`);
    }
  }
};